<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-11-07">

<title>Comprehensive Machine Learning Reoprt – MAchine Learning Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>



</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary">Executive Summary</a></li>
  <li><a href="#key-insights" id="toc-key-insights" class="nav-link" data-scroll-target="#key-insights">Key Insights</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#insurance-dataset" id="toc-insurance-dataset" class="nav-link" data-scroll-target="#insurance-dataset">Insurance Dataset</a></li>
  <li><a href="#iris-dataset" id="toc-iris-dataset" class="nav-link" data-scroll-target="#iris-dataset">Iris Dataset</a></li>
  </ul></li>
  <li><a href="#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing">Data Preprocessing</a></li>
  <li><a href="#limitations-and-constrains" id="toc-limitations-and-constrains" class="nav-link" data-scroll-target="#limitations-and-constrains">Limitations and Constrains</a></li>
  <li><a href="#findings" id="toc-findings" class="nav-link" data-scroll-target="#findings">Findings</a>
  <ul class="collapse">
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#classification-analysis" id="toc-classification-analysis" class="nav-link" data-scroll-target="#classification-analysis">Classification Analysis</a></li>
  <li><a href="#cluster-analysis" id="toc-cluster-analysis" class="nav-link" data-scroll-target="#cluster-analysis">Cluster Analysis</a></li>
  </ul></li>
  <li><a href="#implications" id="toc-implications" class="nav-link" data-scroll-target="#implications">Implications</a></li>
  <li><a href="#insights-and-analysis" id="toc-insights-and-analysis" class="nav-link" data-scroll-target="#insights-and-analysis">Insights and Analysis</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Comprehensive Machine Learning Reoprt</h1>
<p class="subtitle lead">Comprehensive Analysis Using Multiple ML Techniques</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Omkar Ninav </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            3532411003
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Rushabh Shah </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            3532411010
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 7, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary">Executive Summary</h2>
<p>This research report consolidates multiple machine learning assignments performed across various datasets. The key goal was to explore supervised and unsupervised learning techniques to derive insights, build predictive models, and understand data-driven decision-making processes.</p>
</section>
<section id="key-insights" class="level2">
<h2 class="anchored" data-anchor-id="key-insights">Key Insights</h2>
<ul>
<li>Regression analysis on insurance data achieved low explanatory power, indicating need for feature enhancement.</li>
<li>Clustering on Iris dataset effectively separated species using K-Means and Agglomerative algorithms.</li>
<li>Association Rule Mining confirmed petal dimensions as strong predictors of Iris species.</li>
<li>Data preprocessing significantly improved dataset quality for modeling.</li>
</ul>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<ul>
<li>Machine learning algorithms provide valuable insight when data is well-prepared and feature-rich.</li>
<li>Regression performance highlights importance of feature engineering.</li>
<li>Clustering and association results confirm algorithmic efficiency on structured data.</li>
<li>Future studies should improve model tuning and dataset variety for better generalization.</li>
</ul>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This report covers key ML domains:</p>
<ol type="1">
<li><p>Regression on insurance premium prediction.</p></li>
<li><p>Clustering and association rule mining using the Iris dataset.</p></li>
</ol>
<p>The primary research question focused on predicting values and identifying structure within datasets using ML algorithms.</p>
<section id="insurance-dataset" class="level3">
<h3 class="anchored" data-anchor-id="insurance-dataset">Insurance Dataset</h3>
<div id="c3046d41" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>Insurance_df <span class="op">=</span> pd.read_csv(<span class="st">"data/train.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>Insurance_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Gender</th>
<th data-quarto-table-cell-role="th">Annual Income</th>
<th data-quarto-table-cell-role="th">Marital Status</th>
<th data-quarto-table-cell-role="th">Number of Dependents</th>
<th data-quarto-table-cell-role="th">Education Level</th>
<th data-quarto-table-cell-role="th">Occupation</th>
<th data-quarto-table-cell-role="th">Health Score</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Previous Claims</th>
<th data-quarto-table-cell-role="th">Vehicle Age</th>
<th data-quarto-table-cell-role="th">Credit Score</th>
<th data-quarto-table-cell-role="th">Insurance Duration</th>
<th data-quarto-table-cell-role="th">Policy Start Date</th>
<th data-quarto-table-cell-role="th">Customer Feedback</th>
<th data-quarto-table-cell-role="th">Smoking Status</th>
<th data-quarto-table-cell-role="th">Exercise Frequency</th>
<th data-quarto-table-cell-role="th">Property Type</th>
<th data-quarto-table-cell-role="th">Premium Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>19.0</td>
<td>Female</td>
<td>10049.0</td>
<td>Married</td>
<td>1.0</td>
<td>Bachelor's</td>
<td>Self-Employed</td>
<td>22.598761</td>
<td>Urban</td>
<td>...</td>
<td>2.0</td>
<td>17.0</td>
<td>372.0</td>
<td>5.0</td>
<td>2023-12-23 15:21:39.134960</td>
<td>Poor</td>
<td>No</td>
<td>Weekly</td>
<td>House</td>
<td>2869.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>39.0</td>
<td>Female</td>
<td>31678.0</td>
<td>Divorced</td>
<td>3.0</td>
<td>Master's</td>
<td>NaN</td>
<td>15.569731</td>
<td>Rural</td>
<td>...</td>
<td>1.0</td>
<td>12.0</td>
<td>694.0</td>
<td>2.0</td>
<td>2023-06-12 15:21:39.111551</td>
<td>Average</td>
<td>Yes</td>
<td>Monthly</td>
<td>House</td>
<td>1483.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>23.0</td>
<td>Male</td>
<td>25602.0</td>
<td>Divorced</td>
<td>3.0</td>
<td>High School</td>
<td>Self-Employed</td>
<td>47.177549</td>
<td>Suburban</td>
<td>...</td>
<td>1.0</td>
<td>14.0</td>
<td>NaN</td>
<td>3.0</td>
<td>2023-09-30 15:21:39.221386</td>
<td>Good</td>
<td>Yes</td>
<td>Weekly</td>
<td>House</td>
<td>567.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>21.0</td>
<td>Male</td>
<td>141855.0</td>
<td>Married</td>
<td>2.0</td>
<td>Bachelor's</td>
<td>NaN</td>
<td>10.938144</td>
<td>Rural</td>
<td>...</td>
<td>1.0</td>
<td>0.0</td>
<td>367.0</td>
<td>1.0</td>
<td>2024-06-12 15:21:39.226954</td>
<td>Poor</td>
<td>Yes</td>
<td>Daily</td>
<td>Apartment</td>
<td>765.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>21.0</td>
<td>Male</td>
<td>39651.0</td>
<td>Single</td>
<td>1.0</td>
<td>Bachelor's</td>
<td>Self-Employed</td>
<td>20.376094</td>
<td>Rural</td>
<td>...</td>
<td>0.0</td>
<td>8.0</td>
<td>598.0</td>
<td>4.0</td>
<td>2021-12-01 15:21:39.252145</td>
<td>Poor</td>
<td>Yes</td>
<td>Weekly</td>
<td>House</td>
<td>2022.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</section>
<section id="iris-dataset" class="level3">
<h3 class="anchored" data-anchor-id="iris-dataset">Iris Dataset</h3>
<div id="718ea7f4" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>iris <span class="op">=</span> load_iris()</span>
<span id="cb2-2"><a href="#cb2-2"></a>iris_df <span class="op">=</span> pd.DataFrame(iris.data, columns<span class="op">=</span>iris.feature_names)</span>
<span id="cb2-3"><a href="#cb2-3"></a>iris_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sepal length (cm)</th>
<th data-quarto-table-cell-role="th">sepal width (cm)</th>
<th data-quarto-table-cell-role="th">petal length (cm)</th>
<th data-quarto-table-cell-role="th">petal width (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5.1</td>
<td>3.5</td>
<td>1.4</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4.9</td>
<td>3.0</td>
<td>1.4</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4.7</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.6</td>
<td>3.1</td>
<td>1.5</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5.0</td>
<td>3.6</td>
<td>1.4</td>
<td>0.2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="data-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing">Data Preprocessing</h2>
<p><strong>Insurance Dataset:</strong></p>
<ul>
<li>1.2M rows, 20 columns.</li>
<li>Missing values imputed using median/mode; duplicates removed. • Outliers detected in Annual Income and Premium Amount but retained.</li>
</ul>
<p><strong>Iris Dataset:</strong></p>
<ul>
<li>150 rows, 4 features.</li>
<li>Normalized and binned for association analysis. • Feature encoding applied where necessary.</li>
</ul>
</section>
<section id="limitations-and-constrains" class="level2">
<h2 class="anchored" data-anchor-id="limitations-and-constrains">Limitations and Constrains</h2>
<ul>
<li>Regression limited by low variance in normalized target variable.</li>
<li>Clustering relies on correct parameter tuning (eps, linkage).</li>
<li>Small sample in Iris dataset limits deep generalization.</li>
<li>No deep learning models due to computational constraints.</li>
</ul>
</section>
<section id="findings" class="level2">
<h2 class="anchored" data-anchor-id="findings">Findings</h2>
<section id="linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression">Linear Regression</h3>
<div id="4d0b65a2" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score,mean_absolute_error</span>
<span id="cb3-3"><a href="#cb3-3"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb3-4"><a href="#cb3-4"></a>model.fit(X_train, Y_train)</span>
<span id="cb3-5"><a href="#cb3-5"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="bu">print</span>(<span class="ss">f"Mean Squared Error: </span><span class="sc">{</span>mean_squared_error(Y_test,y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="bu">print</span>(<span class="ss">f"R2 Score: </span><span class="sc">{</span>r2_score(Y_test,y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="bu">print</span>(<span class="ss">f"Mean Absolute Error: </span><span class="sc">{</span>mean_absolute_error(Y_test,y_pred)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Squared Error: 0.030054850399406204
R2 Score: 0.00296083662677904
Mean Absolute Error: 0.13399626402463904</code></pre>
</div>
</div>
</section>
<section id="classification-analysis" class="level3">
<h3 class="anchored" data-anchor-id="classification-analysis">Classification Analysis</h3>
<div id="749965b0" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>df_categorized <span class="op">=</span> pd.read_csv(<span class="st">"data/train_categorized.csv"</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>cat_features <span class="op">=</span> [<span class="st">"Gender"</span>, <span class="st">"Marital Status"</span>, <span class="st">"Education Level"</span>, <span class="st">"Occupation"</span>,</span>
<span id="cb5-6"><a href="#cb5-6"></a>                <span class="st">"Location"</span>, <span class="st">"Policy Type"</span>, <span class="st">"Smoking Status"</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a>                <span class="st">"Exercise Frequency"</span>, <span class="st">"Property Type"</span>,<span class="st">"Customer Feedback"</span>,</span>
<span id="cb5-8"><a href="#cb5-8"></a>                <span class="st">"Number of Dependents"</span>, <span class="st">"Previous Claims"</span>, <span class="st">"Insurance Duration"</span>, <span class="st">"Premium Amount Categorized"</span>]</span>
<span id="cb5-9"><a href="#cb5-9"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb5-10"><a href="#cb5-10"></a>df_encoded <span class="op">=</span> df_categorized.copy()</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="cf">for</span> column <span class="kw">in</span> cat_features:</span>
<span id="cb5-12"><a href="#cb5-12"></a>    df_encoded[column] <span class="op">=</span> le.fit_transform(df_categorized[column])</span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a>df_encoded<span class="op">=</span>df_encoded.<span class="bu">apply</span>(pd.to_numeric)</span>
<span id="cb5-15"><a href="#cb5-15"></a>Y <span class="op">=</span> df_encoded[<span class="st">'Premium Amount Categorized'</span>]</span>
<span id="cb5-16"><a href="#cb5-16"></a>X <span class="op">=</span> df_encoded.drop(columns<span class="op">=</span>[<span class="st">'Premium Amount Categorized'</span>, <span class="st">'Premium Amount'</span>])</span>
<span id="cb5-17"><a href="#cb5-17"></a>X_train, X_test, Y_train, Y_test <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="decision-tree-classifier" class="level4">
<h4 class="anchored" data-anchor-id="decision-tree-classifier">Decision Tree Classifier</h4>
<div id="6c4b5463" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>decision_tree <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>,class_weight<span class="op">=</span><span class="st">'balanced'</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>decision_tree.fit(X_train, Y_train)</span>
<span id="cb6-3"><a href="#cb6-3"></a>Y_pred_dt <span class="op">=</span> decision_tree.predict(X_test)</span>
<span id="cb6-4"><a href="#cb6-4"></a>decision_tree_score <span class="op">=</span> decision_tree.score(X_test, Y_test)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="bu">print</span>(<span class="ss">f"Decision Tree  Accuracy: </span><span class="sc">{</span>accuracy_score(Y_test, Y_pred_dt)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="bu">print</span>(<span class="st">"Key Metrics for Decision Tree Classifier:"</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="bu">print</span>(classification_report(Y_test, Y_pred_dt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Decision Tree  Accuracy: 52.22%
Key Metrics for Decision Tree Classifier:
              precision    recall  f1-score   support

           0       0.52      0.52      0.52    179512
           1       0.52      0.52      0.52    180488

    accuracy                           0.52    360000
   macro avg       0.52      0.52      0.52    360000
weighted avg       0.52      0.52      0.52    360000
</code></pre>
</div>
</div>
</section>
<section id="naive-bayes-classifier" class="level4">
<h4 class="anchored" data-anchor-id="naive-bayes-classifier">Naive Bayes Classifier</h4>
<div id="20b6a36f" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb8-2"><a href="#cb8-2"></a>naive_bayes <span class="op">=</span> GaussianNB()</span>
<span id="cb8-3"><a href="#cb8-3"></a>naive_bayes.fit(X_train, Y_train)</span>
<span id="cb8-4"><a href="#cb8-4"></a>Y_pred_nb <span class="op">=</span> naive_bayes.predict(X_test)</span>
<span id="cb8-5"><a href="#cb8-5"></a>naive_bayes_score <span class="op">=</span> naive_bayes.score(X_test, Y_test)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="bu">print</span>(<span class="ss">f"Naive Bayes Accuracy: </span><span class="sc">{</span>accuracy_score(Y_test, Y_pred_nb)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="bu">print</span>(<span class="st">"Key Metrics for Naive Bayes Classifier:"</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="bu">print</span>(classification_report(Y_test, Y_pred_nb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Naive Bayes Accuracy: 52.77%
Key Metrics for Naive Bayes Classifier:
              precision    recall  f1-score   support

           0       0.53      0.45      0.49    179512
           1       0.53      0.60      0.56    180488

    accuracy                           0.53    360000
   macro avg       0.53      0.53      0.53    360000
weighted avg       0.53      0.53      0.53    360000
</code></pre>
</div>
</div>
</section>
<section id="k-nearest-neighbours" class="level4">
<h4 class="anchored" data-anchor-id="k-nearest-neighbours">k-Nearest Neighbours</h4>
<div id="94dd76d3" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb10-2"><a href="#cb10-2"></a>knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>knn.fit(X_train, Y_train)</span>
<span id="cb10-4"><a href="#cb10-4"></a>Y_pred_knn <span class="op">=</span> knn.predict(X_test)</span>
<span id="cb10-5"><a href="#cb10-5"></a>knn_score <span class="op">=</span> knn.score(X_test, Y_test)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="bu">print</span>(<span class="ss">f"k-NN Accuracy: </span><span class="sc">{</span>accuracy_score(Y_test, Y_pred_knn)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="bu">print</span>(<span class="st">"Key Metrics for k-NN Classifier:"</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="bu">print</span>(classification_report(Y_test, Y_pred_knn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>k-NN Accuracy: 50.41%
Key Metrics for k-NN Classifier:
              precision    recall  f1-score   support

           0       0.50      0.50      0.50    179512
           1       0.51      0.51      0.51    180488

    accuracy                           0.50    360000
   macro avg       0.50      0.50      0.50    360000
weighted avg       0.50      0.50      0.50    360000
</code></pre>
</div>
</div>
<p>Summary of Classification Models</p>
<div id="b5096a3e" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a>model_performances <span class="op">=</span> {</span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="st">'Decision Tree'</span>: decision_tree_score,</span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="st">'Naive Bayes'</span>: naive_bayes_score,</span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="st">'k-NN'</span>: knn_score</span>
<span id="cb12-7"><a href="#cb12-7"></a>}</span>
<span id="cb12-8"><a href="#cb12-8"></a>performance_df <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(model_performances.items()), columns<span class="op">=</span>[<span class="st">'Model'</span>, <span class="st">'Accuracy (%)'</span>])</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a>fig <span class="op">=</span> px.bar(performance_df, </span>
<span id="cb12-11"><a href="#cb12-11"></a>             x<span class="op">=</span><span class="st">'Model'</span>, </span>
<span id="cb12-12"><a href="#cb12-12"></a>             y<span class="op">=</span><span class="st">'Accuracy (%)'</span>,</span>
<span id="cb12-13"><a href="#cb12-13"></a>             title<span class="op">=</span><span class="st">'Model Performance Comparison'</span>,</span>
<span id="cb12-14"><a href="#cb12-14"></a>             text<span class="op">=</span><span class="st">'Accuracy (%)'</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a>fig.update_traces(texttemplate<span class="op">=</span><span class="st">'%</span><span class="sc">{text:.2f}</span><span class="st">%'</span>, textposition<span class="op">=</span><span class="st">'outside'</span>)</span>
<span id="cb12-16"><a href="#cb12-16"></a>fig.update_yaxes(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="dv">100</span>])</span>
<span id="cb12-17"><a href="#cb12-17"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="284d327f-ed24-4532-b66e-5b1fb69b28fe" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("284d327f-ed24-4532-b66e-5b1fb69b28fe")) {                    Plotly.newPlot(                        "284d327f-ed24-4532-b66e-5b1fb69b28fe",                        [{"alignmentgroup":"True","hovertemplate":"Model=%{x}\u003cbr\u003eAccuracy (%)=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"text":[52.21666666666667,52.769999999999996,50.41472222222222],"textposition":"outside","x":["Decision Tree","Naive Bayes","k-NN"],"xaxis":"x","y":[52.21666666666667,52.769999999999996,50.41472222222222],"yaxis":"y","type":"bar","texttemplate":"%{text:.2f}%"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Model"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Accuracy (%)"},"range":[0,100]},"legend":{"tracegroupgap":0},"title":{"text":"Model Performance Comparison"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('284d327f-ed24-4532-b66e-5b1fb69b28fe');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
<section id="cluster-analysis" class="level3">
<h3 class="anchored" data-anchor-id="cluster-analysis">Cluster Analysis</h3>
<div id="23b95061" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans, AgglomerativeClustering, DBSCAN</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># Load iris dataset</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>iris_raw <span class="op">=</span> load_iris()</span>
<span id="cb13-7"><a href="#cb13-7"></a>iris_data <span class="op">=</span> pd.DataFrame(iris_raw.data, columns<span class="op">=</span>iris_raw.feature_names)</span>
<span id="cb13-8"><a href="#cb13-8"></a>iris_data[<span class="st">'species'</span>] <span class="op">=</span> iris_raw.target  <span class="co"># numeric target (0,1,2)</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>iris_data[<span class="st">'species_name'</span>] <span class="op">=</span> [iris_raw.target_names[t] <span class="cf">for</span> t <span class="kw">in</span> iris_data[<span class="st">'species'</span>]]</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a>label_encoders <span class="op">=</span> {}</span>
<span id="cb13-12"><a href="#cb13-12"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb13-13"><a href="#cb13-13"></a>iris_data[<span class="st">'species_encoded'</span>] <span class="op">=</span> le.fit_transform(iris_data[<span class="st">'species_name'</span>])</span>
<span id="cb13-14"><a href="#cb13-14"></a>label_encoders[<span class="st">'species_name'</span>] <span class="op">=</span> le </span>
<span id="cb13-15"><a href="#cb13-15"></a>iris_data[[<span class="st">'species_name'</span>, <span class="st">'species_encoded'</span>]].drop_duplicates()</span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a>features <span class="op">=</span> iris_raw.feature_names</span>
<span id="cb13-18"><a href="#cb13-18"></a>X <span class="op">=</span> iris_data[features].copy()</span>
<span id="cb13-19"><a href="#cb13-19"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb13-20"><a href="#cb13-20"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb13-21"><a href="#cb13-21"></a>X_scaled_df <span class="op">=</span> pd.DataFrame(X_scaled, columns<span class="op">=</span>features)</span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co"># Set random state</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>random_state <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb13-25"><a href="#cb13-25"></a></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co"># k-Means</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span>random_state, n_init<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb13-28"><a href="#cb13-28"></a>labels_kmeans <span class="op">=</span> kmeans.fit_predict(X_scaled)</span>
<span id="cb13-29"><a href="#cb13-29"></a></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="co"># Agglomerative Clustering</span></span>
<span id="cb13-31"><a href="#cb13-31"></a>agg <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span><span class="dv">3</span>, linkage<span class="op">=</span><span class="st">'ward'</span>)</span>
<span id="cb13-32"><a href="#cb13-32"></a>labels_agg <span class="op">=</span> agg.fit_predict(X_scaled)</span>
<span id="cb13-33"><a href="#cb13-33"></a></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="co"># DBSCAN</span></span>
<span id="cb13-35"><a href="#cb13-35"></a>dbscan <span class="op">=</span> DBSCAN(eps<span class="op">=</span><span class="fl">0.6</span>, min_samples<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb13-36"><a href="#cb13-36"></a>labels_db <span class="op">=</span> dbscan.fit_predict(X_scaled)</span>
<span id="cb13-37"><a href="#cb13-37"></a></span>
<span id="cb13-38"><a href="#cb13-38"></a>iris_data[<span class="st">'cluster_kmeans'</span>] <span class="op">=</span> labels_kmeans</span>
<span id="cb13-39"><a href="#cb13-39"></a>iris_data[<span class="st">'cluster_agg'</span>] <span class="op">=</span> labels_agg</span>
<span id="cb13-40"><a href="#cb13-40"></a>iris_data[<span class="st">'cluster_dbscan'</span>] <span class="op">=</span> labels_db</span>
<span id="cb13-41"><a href="#cb13-41"></a></span>
<span id="cb13-42"><a href="#cb13-42"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span>random_state)</span>
<span id="cb13-43"><a href="#cb13-43"></a>pca_result <span class="op">=</span> pca.fit_transform(X_scaled)</span>
<span id="cb13-44"><a href="#cb13-44"></a>iris_data[<span class="st">'pca1'</span>] <span class="op">=</span> pca_result[:, <span class="dv">0</span>]</span>
<span id="cb13-45"><a href="#cb13-45"></a>iris_data[<span class="st">'pca2'</span>] <span class="op">=</span> pca_result[:, <span class="dv">1</span>]</span>
<span id="cb13-46"><a href="#cb13-46"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb13-47"><a href="#cb13-47"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb13-48"><a href="#cb13-48"></a></span>
<span id="cb13-49"><a href="#cb13-49"></a><span class="kw">def</span> plot_clusters(df, x<span class="op">=</span><span class="st">'pca1'</span>, y<span class="op">=</span><span class="st">'pca2'</span>, label_col<span class="op">=</span><span class="st">'cluster'</span>, title<span class="op">=</span><span class="st">'Clusters'</span>, palette<span class="op">=</span><span class="st">'tab10'</span>, show_centers<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb13-50"><a href="#cb13-50"></a>    labels <span class="op">=</span> df[label_col]</span>
<span id="cb13-51"><a href="#cb13-51"></a>    unique_labels <span class="op">=</span> np.unique(labels)</span>
<span id="cb13-52"><a href="#cb13-52"></a>    </span>
<span id="cb13-53"><a href="#cb13-53"></a>    <span class="co"># Create figure</span></span>
<span id="cb13-54"><a href="#cb13-54"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb13-55"><a href="#cb13-55"></a>    </span>
<span id="cb13-56"><a href="#cb13-56"></a>    <span class="co"># Get colors from seaborn palette</span></span>
<span id="cb13-57"><a href="#cb13-57"></a>    palette_map <span class="op">=</span> sns.color_palette(palette, n_colors<span class="op">=</span><span class="bu">len</span>(unique_labels))</span>
<span id="cb13-58"><a href="#cb13-58"></a>    </span>
<span id="cb13-59"><a href="#cb13-59"></a>    <span class="co"># Plot each cluster</span></span>
<span id="cb13-60"><a href="#cb13-60"></a>    <span class="cf">for</span> i, lab <span class="kw">in</span> <span class="bu">enumerate</span>(unique_labels):</span>
<span id="cb13-61"><a href="#cb13-61"></a>        mask <span class="op">=</span> labels <span class="op">==</span> lab</span>
<span id="cb13-62"><a href="#cb13-62"></a>        </span>
<span id="cb13-63"><a href="#cb13-63"></a>        <span class="cf">if</span> lab <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb13-64"><a href="#cb13-64"></a>            color <span class="op">=</span> <span class="st">'black'</span></span>
<span id="cb13-65"><a href="#cb13-65"></a>            lab_name <span class="op">=</span> <span class="st">'noise'</span></span>
<span id="cb13-66"><a href="#cb13-66"></a>        <span class="cf">else</span>:</span>
<span id="cb13-67"><a href="#cb13-67"></a>            <span class="co"># Convert seaborn RGB to plotly format</span></span>
<span id="cb13-68"><a href="#cb13-68"></a>            color <span class="op">=</span> <span class="ss">f'rgb(</span><span class="sc">{</span><span class="bu">int</span>(palette_map[i][<span class="dv">0</span>]<span class="op">*</span><span class="dv">255</span>)<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="bu">int</span>(palette_map[i][<span class="dv">1</span>]<span class="op">*</span><span class="dv">255</span>)<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="bu">int</span>(palette_map[i][<span class="dv">2</span>]<span class="op">*</span><span class="dv">255</span>)<span class="sc">}</span><span class="ss">)'</span></span>
<span id="cb13-69"><a href="#cb13-69"></a>            lab_name <span class="op">=</span> <span class="bu">str</span>(lab)</span>
<span id="cb13-70"><a href="#cb13-70"></a>        </span>
<span id="cb13-71"><a href="#cb13-71"></a>        fig.add_trace(go.Scatter(</span>
<span id="cb13-72"><a href="#cb13-72"></a>            x<span class="op">=</span>df.loc[mask, x],</span>
<span id="cb13-73"><a href="#cb13-73"></a>            y<span class="op">=</span>df.loc[mask, y],</span>
<span id="cb13-74"><a href="#cb13-74"></a>            mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb13-75"><a href="#cb13-75"></a>            name<span class="op">=</span>lab_name,</span>
<span id="cb13-76"><a href="#cb13-76"></a>            marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">8</span>, color<span class="op">=</span>color, opacity<span class="op">=</span><span class="fl">0.75</span>),</span>
<span id="cb13-77"><a href="#cb13-77"></a>            legendgroup<span class="op">=</span>lab_name</span>
<span id="cb13-78"><a href="#cb13-78"></a>        ))</span>
<span id="cb13-79"><a href="#cb13-79"></a>    </span>
<span id="cb13-80"><a href="#cb13-80"></a>    <span class="co"># Add cluster centers if provided</span></span>
<span id="cb13-81"><a href="#cb13-81"></a>    <span class="cf">if</span> show_centers <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb13-82"><a href="#cb13-82"></a>        fig.add_trace(go.Scatter(</span>
<span id="cb13-83"><a href="#cb13-83"></a>            x<span class="op">=</span>show_centers[:, <span class="dv">0</span>],</span>
<span id="cb13-84"><a href="#cb13-84"></a>            y<span class="op">=</span>show_centers[:, <span class="dv">1</span>],</span>
<span id="cb13-85"><a href="#cb13-85"></a>            mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb13-86"><a href="#cb13-86"></a>            name<span class="op">=</span><span class="st">'centers'</span>,</span>
<span id="cb13-87"><a href="#cb13-87"></a>            marker<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb13-88"><a href="#cb13-88"></a>                size<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb13-89"><a href="#cb13-89"></a>                color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb13-90"><a href="#cb13-90"></a>                symbol<span class="op">=</span><span class="st">'x'</span>,</span>
<span id="cb13-91"><a href="#cb13-91"></a>                line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, width<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb13-92"><a href="#cb13-92"></a>            )</span>
<span id="cb13-93"><a href="#cb13-93"></a>        ))</span>
<span id="cb13-94"><a href="#cb13-94"></a>    </span>
<span id="cb13-95"><a href="#cb13-95"></a>    <span class="co"># Update layout</span></span>
<span id="cb13-96"><a href="#cb13-96"></a>    fig.update_layout(</span>
<span id="cb13-97"><a href="#cb13-97"></a>        title<span class="op">=</span>title,</span>
<span id="cb13-98"><a href="#cb13-98"></a>        xaxis_title<span class="op">=</span>x,</span>
<span id="cb13-99"><a href="#cb13-99"></a>        yaxis_title<span class="op">=</span>y,</span>
<span id="cb13-100"><a href="#cb13-100"></a>        legend_title<span class="op">=</span><span class="st">'cluster'</span>,</span>
<span id="cb13-101"><a href="#cb13-101"></a>        width<span class="op">=</span><span class="dv">680</span>,</span>
<span id="cb13-102"><a href="#cb13-102"></a>        height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb13-103"><a href="#cb13-103"></a>        hovermode<span class="op">=</span><span class="st">'closest'</span></span>
<span id="cb13-104"><a href="#cb13-104"></a>    )</span>
<span id="cb13-105"><a href="#cb13-105"></a>    </span>
<span id="cb13-106"><a href="#cb13-106"></a>    fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="k-means" class="level4">
<h4 class="anchored" data-anchor-id="k-means">K-Means</h4>
<div id="f9666af7" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>k_centers_pca <span class="op">=</span> pca.transform(kmeans.cluster_centers_)</span>
<span id="cb14-2"><a href="#cb14-2"></a>plot_clusters(iris_data, label_col<span class="op">=</span><span class="st">'cluster_kmeans'</span>, title<span class="op">=</span><span class="st">'K-Means clusters'</span>, show_centers<span class="op">=</span>k_centers_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="236ac1bb-9048-4752-b8fa-d71fa629f640" class="plotly-graph-div" style="height:500px; width:680px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("236ac1bb-9048-4752-b8fa-d71fa629f640")) {                    Plotly.newPlot(                        "236ac1bb-9048-4752-b8fa-d71fa629f640",                        [{"legendgroup":"0","marker":{"color":"rgb(31, 119, 180)","opacity":0.75,"size":8},"mode":"markers","name":"0","x":[0.4074830588173844,1.0754747006090775,0.3886873365356646,-0.4873227421256398,0.9279016383549449,0.011426188736980036,-0.1101962800006295,0.44069344898307816,0.5621083064431782,0.7195618886754961,-0.033354703178772316,0.3502516679950826,0.1588100475479711,1.2250936335624305,0.16491789938632692,0.476287190940971,1.2341780976571484,0.6328581997098213,0.7026611831361819,0.6648003672253944,-0.040258610900595654,0.13079517549786016,0.023452688970550438,0.2415382729545106,1.0610946088426134,0.2239787735123796,1.044531384396278,0.0695883211164229,0.28347723828757493,0.2790777760554606,0.6245697914985712,0.3365303701314354,-0.36218338461938354,0.28858623882315704,0.0913606556545053,0.22771686553469983,0.5763882886534784,-0.4476670190286118,0.25673058888758443,1.157881613205779,0.367017687860724,1.2601150991975067,1.467645201017323,1.2637666736398272,0.977980734249421,1.333232175973208,1.175103631554932,1.1141477406864742,1.20247330167839,0.9248249165424189,1.157881613205779,1.5645804830303272,0.9606560300371275],"y":[-1.7544039893234091,-0.20842104605096504,-0.593283635990075,-1.8524290868575732,0.03222607789115422,-1.0340182751294402,-2.6540728185365623,-0.0632951884380016,-1.7647243806169433,-0.18622460583150563,-0.43900320998162456,-0.19631173455144435,-0.7920957424327207,-1.6222438030915,-1.3026092302957717,-0.4173202812135504,-0.9333257287992777,-0.416387720889099,-0.06341181972479971,-0.2259278546948435,-1.0587185465539077,-1.5622718342099664,-1.5724755942167032,-0.7772563825848412,-0.6338432447349467,-0.2877735120432027,-1.3829887191907801,-0.21950333464771515,-1.3293246390695757,-1.120028523742403,0.024923029254012574,-0.9884040176703592,-2.0192378732386103,-0.855730319987066,-0.18119212582577535,-0.38492008098735375,-0.1548735972165585,-1.5437920343977554,-0.5988517961556692,-0.6988698623306905,-1.5615028914765057,-1.1622604214064634,-0.44227158737708294,-1.7067453803762662,-0.5717643248129921,-0.481811218649429,-0.31639447230979095,-0.29292262333573116,-0.811315270839668,0.017223100452283768,-0.6988698623306905,-0.8966868088965257,-0.02433166816939981],"type":"scatter"},{"legendgroup":"1","marker":{"color":"rgb(255, 127, 14)","opacity":0.75,"size":8},"mode":"markers","name":"1","x":[-2.264702808807587,-2.0809611519657665,-2.3642290538902992,-2.299384217042707,-2.389842166313843,-2.0756309481765105,-2.444028835134151,-2.2328471588720133,-2.3346404779076204,-2.184328174933941,-2.166310100701321,-2.326130866442697,-2.218450898822408,-2.6331006957652265,-2.1987406032666885,-2.2622145316010194,-2.20758769582459,-2.190349509192297,-1.8985719958028404,-2.343369053074991,-1.9143229960825667,-2.207012843194797,-2.7743447029273303,-1.8186695286958483,-2.227163305706637,-1.951846330900375,-2.051151372729414,-2.168577174654215,-2.13956345130133,-2.2652614931542394,-2.1401221356479834,-1.8315947706760272,-2.6149479358589325,-2.4461773916965126,-2.109974875318651,-2.2078088990782647,-2.0451462067542,-2.5273319131704843,-2.4296325750845447,-2.169710711630662,-2.2864751433456685,-1.8581224563735708,-2.5536383956143545,-1.9644476837637392,-2.1370590058116212,-2.0697442995918287,-2.3847331657782607,-2.3943763142196315,-2.229446547942673,-2.2038334355191287],"y":[0.4800265965209889,-0.6741335566053523,-0.3419080238846761,-0.5973945076746755,0.6468353829020262,1.4891775233211653,0.047644197630013645,0.22314807268959147,-1.1153276754616657,-0.4690135614023753,1.0436906530538592,0.13307833523923124,-0.7286761653165702,-0.9615067291701624,1.8600571132939299,2.68628448511059,1.4836093631555711,0.4888383164863272,1.4050187944665482,1.127849381908475,0.408855707755906,0.9241214267468975,0.4583436677529146,0.08555852628736596,0.13725445536342684,-0.6256185877766761,0.24216355266166664,0.527149525308267,0.3132178101399517,-0.3377319037604805,-0.5045406901415181,0.4236950676037856,1.7935758561044273,2.1507278773929226,-0.460201841437037,-0.20610739768843667,0.6615581114631078,0.5922927741908087,-0.9041800403761475,0.26887896143547063,0.44171538769904956,-2.3374151575533464,-0.47910069012231404,0.4723266677192601,1.1422292620394072,-0.7110527253858936,1.120429701984535,-0.3862468725891572,0.9979597643079795,0.009216357521276215],"type":"scatter"},{"legendgroup":"2","marker":{"color":"rgb(44, 160, 44)","opacity":0.75,"size":8},"mode":"markers","name":"2","x":[1.1017811830529474,0.7313374253960873,1.2409793195158307,0.7465297413291606,0.8754071908577373,0.737682648771258,0.87427365388129,1.256509116541883,1.3584051214406314,0.4291391155161608,1.048728051209087,1.8445688677230283,2.205266791075377,1.4401506638275388,1.8678122203305367,2.7518733356662755,2.302439444625196,2.0066864676766047,2.2597773490125,1.3641754921860074,1.6026786704779297,1.8839007017032419,1.590077317614565,1.4714314611333175,2.4263289873157,3.310695583933886,2.0377163014694037,2.8976514907341673,1.7007338974912167,1.9543267058530702,1.0209505506957905,1.7883499201796647,1.8636475533282604,2.435953727922702,2.3049277218317643,1.8627032197949545,2.798770447578107,1.5762559101947535,1.3462921036270612,1.8520450517676694,2.0148104299548746,1.9017840902621883,2.0405582280520917,1.9981470959523755,1.8705032929564098,1.521170499627837,1.3727877895140725],"y":[0.8629724182621588,0.5946147256694241,0.6162976544374982,0.7730193120985956,0.5090639567734085,0.396571561960238,0.2507933929006122,-0.07725601969586832,0.3313116817908981,0.8455822409050774,0.5220517968629425,0.8704213123248216,0.5620104770083554,-0.04698758810580676,0.29504482445701913,0.8004092010275419,0.4200655796427764,-0.7114386535471581,1.9210103764598845,0.6927564544903861,-0.42170044977261695,0.4192496506051232,0.676244805723319,0.25562182447147025,2.5566612507954902,0.017780949320627674,0.9104674096183099,0.4136410595956481,1.0139218673227903,1.0077775961534519,0.0643460292395615,-0.18736121459082894,0.5622907258861447,0.2592844331442805,2.6263234682323766,-0.1785494946254906,0.8568033294971054,1.0685811073208058,0.42243061085250777,0.676128174436521,0.6138856369235741,0.6895754942430019,0.8675206009552273,1.0491687471841435,0.38696608166572505,0.2690691442779513,1.0112544185267913],"type":"scatter"},{"marker":{"color":"red","line":{"color":"black","width":2},"size":15,"symbol":"x"},"mode":"markers","name":"centers","x":[0.5726214350030153,-2.2247531601152404,1.7210366372468557],"y":[-0.8072088776157749,0.2889274510182057,0.602887190696294],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"K-Means clusters"},"xaxis":{"title":{"text":"pca1"}},"yaxis":{"title":{"text":"pca2"}},"legend":{"title":{"text":"cluster"}},"width":680,"height":500,"hovermode":"closest"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('236ac1bb-9048-4752-b8fa-d71fa629f640');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="heirarchical-agglomaration" class="level4">
<h4 class="anchored" data-anchor-id="heirarchical-agglomaration">Heirarchical Agglomaration</h4>
<div id="c9ce73f1" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>plot_clusters(iris_data, label_col<span class="op">=</span><span class="st">'cluster_agg'</span>, title<span class="op">=</span><span class="st">'Agglomerative clusters'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="9b32e2ee-c627-4979-8be5-db5091bbc999" class="plotly-graph-div" style="height:500px; width:680px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9b32e2ee-c627-4979-8be5-db5091bbc999")) {                    Plotly.newPlot(                        "9b32e2ee-c627-4979-8be5-db5091bbc999",                        [{"legendgroup":"0","marker":{"color":"rgb(31, 119, 180)","opacity":0.75,"size":8},"mode":"markers","name":"0","x":[1.1017811830529474,0.7313374253960873,1.2409793195158307,1.0754747006090775,0.7465297413291606,0.9279016383549449,0.44069344898307816,0.7195618886754961,0.8754071908577373,0.737682648771258,0.476287190940971,1.2341780976571484,0.6328581997098213,0.7026611831361819,0.87427365388129,1.256509116541883,1.3584051214406314,0.6648003672253944,1.0610946088426134,0.4291391155161608,1.048728051209087,0.6245697914985712,0.5763882886534784,1.8445688677230283,1.157881613205779,2.205266791075377,1.4401506638275388,1.8678122203305367,2.7518733356662755,2.302439444625196,2.0066864676766047,2.2597773490125,1.3641754921860074,1.6026786704779297,1.8839007017032419,1.2601150991975067,1.467645201017323,1.590077317614565,1.4714314611333175,2.4263289873157,3.310695583933886,2.0377163014694037,0.977980734249421,2.8976514907341673,1.333232175973208,1.7007338974912167,1.9543267058530702,1.175103631554932,1.0209505506957905,1.7883499201796647,1.8636475533282604,2.435953727922702,2.3049277218317643,1.8627032197949545,1.1141477406864742,1.20247330167839,2.798770447578107,1.5762559101947535,1.3462921036270612,0.9248249165424189,1.8520450517676694,2.0148104299548746,1.9017840902621883,1.157881613205779,2.0405582280520917,1.9981470959523755,1.8705032929564098,1.5645804830303272,1.521170499627837,1.3727877895140725,0.9606560300371275],"y":[0.8629724182621588,0.5946147256694241,0.6162976544374982,-0.20842104605096504,0.7730193120985956,0.03222607789115422,-0.0632951884380016,-0.18622460583150563,0.5090639567734085,0.396571561960238,-0.4173202812135504,-0.9333257287992777,-0.416387720889099,-0.06341181972479971,0.2507933929006122,-0.07725601969586832,0.3313116817908981,-0.2259278546948435,-0.6338432447349467,0.8455822409050774,0.5220517968629425,0.024923029254012574,-0.1548735972165585,0.8704213123248216,-0.6988698623306905,0.5620104770083554,-0.04698758810580676,0.29504482445701913,0.8004092010275419,0.4200655796427764,-0.7114386535471581,1.9210103764598845,0.6927564544903861,-0.42170044977261695,0.4192496506051232,-1.1622604214064634,-0.44227158737708294,0.676244805723319,0.25562182447147025,2.5566612507954902,0.017780949320627674,0.9104674096183099,-0.5717643248129921,0.4136410595956481,-0.481811218649429,1.0139218673227903,1.0077775961534519,-0.31639447230979095,0.0643460292395615,-0.18736121459082894,0.5622907258861447,0.2592844331442805,2.6263234682323766,-0.1785494946254906,-0.29292262333573116,-0.811315270839668,0.8568033294971054,1.0685811073208058,0.42243061085250777,0.017223100452283768,0.676128174436521,0.6138856369235741,0.6895754942430019,-0.6988698623306905,0.8675206009552273,1.0491687471841435,0.38696608166572505,-0.8966868088965257,0.2690691442779513,1.0112544185267913,-0.02433166816939981],"type":"scatter"},{"legendgroup":"1","marker":{"color":"rgb(255, 127, 14)","opacity":0.75,"size":8},"mode":"markers","name":"1","x":[-2.264702808807587,-2.0809611519657665,-2.3642290538902992,-2.299384217042707,-2.389842166313843,-2.0756309481765105,-2.444028835134151,-2.2328471588720133,-2.3346404779076204,-2.184328174933941,-2.166310100701321,-2.326130866442697,-2.218450898822408,-2.6331006957652265,-2.1987406032666885,-2.2622145316010194,-2.20758769582459,-2.190349509192297,-1.8985719958028404,-2.343369053074991,-1.9143229960825667,-2.207012843194797,-2.7743447029273303,-1.8186695286958483,-2.227163305706637,-1.951846330900375,-2.051151372729414,-2.168577174654215,-2.13956345130133,-2.2652614931542394,-2.1401221356479834,-1.8315947706760272,-2.6149479358589325,-2.4461773916965126,-2.109974875318651,-2.2078088990782647,-2.0451462067542,-2.5273319131704843,-2.4296325750845447,-2.169710711630662,-2.2864751433456685,-2.5536383956143545,-1.9644476837637392,-2.1370590058116212,-2.0697442995918287,-2.3847331657782607,-2.3943763142196315,-2.229446547942673,-2.2038334355191287],"y":[0.4800265965209889,-0.6741335566053523,-0.3419080238846761,-0.5973945076746755,0.6468353829020262,1.4891775233211653,0.047644197630013645,0.22314807268959147,-1.1153276754616657,-0.4690135614023753,1.0436906530538592,0.13307833523923124,-0.7286761653165702,-0.9615067291701624,1.8600571132939299,2.68628448511059,1.4836093631555711,0.4888383164863272,1.4050187944665482,1.127849381908475,0.408855707755906,0.9241214267468975,0.4583436677529146,0.08555852628736596,0.13725445536342684,-0.6256185877766761,0.24216355266166664,0.527149525308267,0.3132178101399517,-0.3377319037604805,-0.5045406901415181,0.4236950676037856,1.7935758561044273,2.1507278773929226,-0.460201841437037,-0.20610739768843667,0.6615581114631078,0.5922927741908087,-0.9041800403761475,0.26887896143547063,0.44171538769904956,-0.47910069012231404,0.4723266677192601,1.1422292620394072,-0.7110527253858936,1.120429701984535,-0.3862468725891572,0.9979597643079795,0.009216357521276215],"type":"scatter"},{"legendgroup":"2","marker":{"color":"rgb(44, 160, 44)","opacity":0.75,"size":8},"mode":"markers","name":"2","x":[-1.8581224563735708,0.4074830588173844,0.3886873365356646,-0.4873227421256398,0.011426188736980036,-0.1101962800006295,0.5621083064431782,-0.033354703178772316,0.3502516679950826,0.1588100475479711,1.2250936335624305,0.16491789938632692,-0.040258610900595654,0.13079517549786016,0.023452688970550438,0.2415382729545106,0.2239787735123796,1.044531384396278,0.0695883211164229,0.28347723828757493,0.2790777760554606,0.3365303701314354,-0.36218338461938354,0.28858623882315704,0.0913606556545053,0.22771686553469983,-0.4476670190286118,0.25673058888758443,0.367017687860724,1.2637666736398272],"y":[-2.3374151575533464,-1.7544039893234091,-0.593283635990075,-1.8524290868575732,-1.0340182751294402,-2.6540728185365623,-1.7647243806169433,-0.43900320998162456,-0.19631173455144435,-0.7920957424327207,-1.6222438030915,-1.3026092302957717,-1.0587185465539077,-1.5622718342099664,-1.5724755942167032,-0.7772563825848412,-0.2877735120432027,-1.3829887191907801,-0.21950333464771515,-1.3293246390695757,-1.120028523742403,-0.9884040176703592,-2.0192378732386103,-0.855730319987066,-0.18119212582577535,-0.38492008098735375,-1.5437920343977554,-0.5988517961556692,-1.5615028914765057,-1.7067453803762662],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"Agglomerative clusters"},"xaxis":{"title":{"text":"pca1"}},"yaxis":{"title":{"text":"pca2"}},"legend":{"title":{"text":"cluster"}},"width":680,"height":500,"hovermode":"closest"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9b32e2ee-c627-4979-8be5-db5091bbc999');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="dbscan" class="level4">
<h4 class="anchored" data-anchor-id="dbscan">DBSCAN</h4>
<div id="2816b2c0" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>plot_clusters(iris_data, label_col<span class="op">=</span><span class="st">'cluster_dbscan'</span>, title<span class="op">=</span><span class="st">'DBSCAN clusters'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>                            <div id="cdadeac5-7851-4e82-a97a-e8ea5cc9b7c1" class="plotly-graph-div" style="height:500px; width:680px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("cdadeac5-7851-4e82-a97a-e8ea5cc9b7c1")) {                    Plotly.newPlot(                        "cdadeac5-7851-4e82-a97a-e8ea5cc9b7c1",                        [{"legendgroup":"noise","marker":{"color":"black","opacity":0.75,"size":8},"mode":"markers","name":"noise","x":[-2.2622145316010194,-2.6149479358589325,-2.4461773916965126,-1.8581224563735708,-0.4873227421256398,-0.1101962800006295,0.5621083064431782,1.2250936335624305,1.2341780976571484,1.044531384396278,-0.36218338461938354,-0.4476670190286118,2.7518733356662755,0.367017687860724,2.0066864676766047,2.2597773490125,1.467645201017323,2.4263289873157,3.310695583933886,1.2637666736398272,2.8976514907341673,1.9543267058530702,1.8636475533282604,2.435953727922702,2.3049277218317643,2.798770447578107],"y":[2.68628448511059,1.7935758561044273,2.1507278773929226,-2.3374151575533464,-1.8524290868575732,-2.6540728185365623,-1.7647243806169433,-1.6222438030915,-0.9333257287992777,-1.3829887191907801,-2.0192378732386103,-1.5437920343977554,0.8004092010275419,-1.5615028914765057,-0.7114386535471581,1.9210103764598845,-0.44227158737708294,2.5566612507954902,0.017780949320627674,-1.7067453803762662,0.4136410595956481,1.0077775961534519,0.5622907258861447,0.2592844331442805,2.6263234682323766,0.8568033294971054],"type":"scatter"},{"legendgroup":"0","marker":{"color":"rgb(255, 127, 14)","opacity":0.75,"size":8},"mode":"markers","name":"0","x":[-2.264702808807587,-2.0809611519657665,-2.3642290538902992,-2.299384217042707,-2.389842166313843,-2.0756309481765105,-2.444028835134151,-2.2328471588720133,-2.3346404779076204,-2.184328174933941,-2.166310100701321,-2.326130866442697,-2.218450898822408,-2.6331006957652265,-2.1987406032666885,-2.20758769582459,-2.190349509192297,-1.8985719958028404,-2.343369053074991,-1.9143229960825667,-2.207012843194797,-2.7743447029273303,-1.8186695286958483,-2.227163305706637,-1.951846330900375,-2.051151372729414,-2.168577174654215,-2.13956345130133,-2.2652614931542394,-2.1401221356479834,-1.8315947706760272,-2.109974875318651,-2.2078088990782647,-2.0451462067542,-2.5273319131704843,-2.4296325750845447,-2.169710711630662,-2.2864751433456685,-2.5536383956143545,-1.9644476837637392,-2.1370590058116212,-2.0697442995918287,-2.3847331657782607,-2.3943763142196315,-2.229446547942673,-2.2038334355191287],"y":[0.4800265965209889,-0.6741335566053523,-0.3419080238846761,-0.5973945076746755,0.6468353829020262,1.4891775233211653,0.047644197630013645,0.22314807268959147,-1.1153276754616657,-0.4690135614023753,1.0436906530538592,0.13307833523923124,-0.7286761653165702,-0.9615067291701624,1.8600571132939299,1.4836093631555711,0.4888383164863272,1.4050187944665482,1.127849381908475,0.408855707755906,0.9241214267468975,0.4583436677529146,0.08555852628736596,0.13725445536342684,-0.6256185877766761,0.24216355266166664,0.527149525308267,0.3132178101399517,-0.3377319037604805,-0.5045406901415181,0.4236950676037856,-0.460201841437037,-0.20610739768843667,0.6615581114631078,0.5922927741908087,-0.9041800403761475,0.26887896143547063,0.44171538769904956,-0.47910069012231404,0.4723266677192601,1.1422292620394072,-0.7110527253858936,1.120429701984535,-0.3862468725891572,0.9979597643079795,0.009216357521276215],"type":"scatter"},{"legendgroup":"1","marker":{"color":"rgb(44, 160, 44)","opacity":0.75,"size":8},"mode":"markers","name":"1","x":[1.1017811830529474,0.7313374253960873,1.2409793195158307,0.4074830588173844,1.0754747006090775,0.3886873365356646,0.7465297413291606,0.9279016383549449,0.011426188736980036,0.44069344898307816,0.7195618886754961,-0.033354703178772316,0.8754071908577373,0.3502516679950826,0.1588100475479711,0.16491789938632692,0.737682648771258,0.476287190940971,0.6328581997098213,0.7026611831361819,0.87427365388129,1.256509116541883,1.3584051214406314,0.6648003672253944,-0.040258610900595654,0.13079517549786016,0.023452688970550438,0.2415382729545106,1.0610946088426134,0.2239787735123796,0.4291391155161608,1.048728051209087,0.0695883211164229,0.28347723828757493,0.2790777760554606,0.6245697914985712,0.3365303701314354,0.28858623882315704,0.0913606556545053,0.22771686553469983,0.5763882886534784,0.25673058888758443,1.8445688677230283,1.157881613205779,2.205266791075377,1.4401506638275388,1.8678122203305367,2.302439444625196,1.3641754921860074,1.6026786704779297,1.8839007017032419,1.2601150991975067,1.590077317614565,1.4714314611333175,2.0377163014694037,0.977980734249421,1.333232175973208,1.7007338974912167,1.175103631554932,1.0209505506957905,1.7883499201796647,1.8627032197949545,1.1141477406864742,1.20247330167839,1.5762559101947535,1.3462921036270612,0.9248249165424189,1.8520450517676694,2.0148104299548746,1.9017840902621883,1.157881613205779,2.0405582280520917,1.9981470959523755,1.8705032929564098,1.5645804830303272,1.521170499627837,1.3727877895140725,0.9606560300371275],"y":[0.8629724182621588,0.5946147256694241,0.6162976544374982,-1.7544039893234091,-0.20842104605096504,-0.593283635990075,0.7730193120985956,0.03222607789115422,-1.0340182751294402,-0.0632951884380016,-0.18622460583150563,-0.43900320998162456,0.5090639567734085,-0.19631173455144435,-0.7920957424327207,-1.3026092302957717,0.396571561960238,-0.4173202812135504,-0.416387720889099,-0.06341181972479971,0.2507933929006122,-0.07725601969586832,0.3313116817908981,-0.2259278546948435,-1.0587185465539077,-1.5622718342099664,-1.5724755942167032,-0.7772563825848412,-0.6338432447349467,-0.2877735120432027,0.8455822409050774,0.5220517968629425,-0.21950333464771515,-1.3293246390695757,-1.120028523742403,0.024923029254012574,-0.9884040176703592,-0.855730319987066,-0.18119212582577535,-0.38492008098735375,-0.1548735972165585,-0.5988517961556692,0.8704213123248216,-0.6988698623306905,0.5620104770083554,-0.04698758810580676,0.29504482445701913,0.4200655796427764,0.6927564544903861,-0.42170044977261695,0.4192496506051232,-1.1622604214064634,0.676244805723319,0.25562182447147025,0.9104674096183099,-0.5717643248129921,-0.481811218649429,1.0139218673227903,-0.31639447230979095,0.0643460292395615,-0.18736121459082894,-0.1785494946254906,-0.29292262333573116,-0.811315270839668,1.0685811073208058,0.42243061085250777,0.017223100452283768,0.676128174436521,0.6138856369235741,0.6895754942430019,-0.6988698623306905,0.8675206009552273,1.0491687471841435,0.38696608166572505,-0.8966868088965257,0.2690691442779513,1.0112544185267913,-0.02433166816939981],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"DBSCAN clusters"},"xaxis":{"title":{"text":"pca1"}},"yaxis":{"title":{"text":"pca2"}},"legend":{"title":{"text":"cluster"}},"width":680,"height":500,"hovermode":"closest"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('cdadeac5-7851-4e82-a97a-e8ea5cc9b7c1');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="apriori-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="apriori-algorithm">Apriori Algorithm</h4>
<div id="c0d1f8db" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Create a copy of iris data with species information</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>iris_binned <span class="op">=</span> iris_data[iris_raw.feature_names].copy()</span>
<span id="cb17-3"><a href="#cb17-3"></a>iris_binned[<span class="st">'species'</span>] <span class="op">=</span> iris_data[<span class="st">'species_name'</span>]</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co"># Bin numerical columns into categories</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>num_cols <span class="op">=</span> iris_raw.feature_names</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="cf">for</span> col <span class="kw">in</span> num_cols:</span>
<span id="cb17-8"><a href="#cb17-8"></a>    iris_binned[col] <span class="op">=</span> pd.qcut(iris_binned[col], q<span class="op">=</span><span class="dv">3</span>, labels<span class="op">=</span>[<span class="st">'Low'</span>,<span class="st">'Medium'</span>,<span class="st">'High'</span>])</span>
<span id="cb17-9"><a href="#cb17-9"></a></span>
<span id="cb17-10"><a href="#cb17-10"></a>iris_binned[<span class="st">'species'</span>] <span class="op">=</span> iris_binned[<span class="st">'species'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb17-11"><a href="#cb17-11"></a></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co"># Create transaction format</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>df_items <span class="op">=</span> iris_binned.copy()</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="cf">for</span> col <span class="kw">in</span> df_items.columns:</span>
<span id="cb17-15"><a href="#cb17-15"></a>    df_items[col] <span class="op">=</span> col <span class="op">+</span> <span class="st">'='</span> <span class="op">+</span> df_items[col].astype(<span class="bu">str</span>)</span>
<span id="cb17-16"><a href="#cb17-16"></a></span>
<span id="cb17-17"><a href="#cb17-17"></a>trans_df <span class="op">=</span> pd.get_dummies(df_items)</span>
<span id="cb17-18"><a href="#cb17-18"></a></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="im">from</span> mlxtend.frequent_patterns <span class="im">import</span> apriori</span>
<span id="cb17-20"><a href="#cb17-20"></a>min_support <span class="op">=</span> <span class="fl">0.10</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>frequent_itemsets <span class="op">=</span> apriori(trans_df, min_support<span class="op">=</span>min_support, use_colnames<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-22"><a href="#cb17-22"></a></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="im">from</span> mlxtend.frequent_patterns <span class="im">import</span> association_rules</span>
<span id="cb17-24"><a href="#cb17-24"></a>min_confidence <span class="op">=</span> <span class="fl">0.6</span></span>
<span id="cb17-25"><a href="#cb17-25"></a>rules <span class="op">=</span> association_rules(frequent_itemsets, metric<span class="op">=</span><span class="st">"lift"</span>, min_threshold<span class="op">=</span>min_confidence)</span>
<span id="cb17-26"><a href="#cb17-26"></a>rules <span class="op">=</span> rules.sort_values(by<span class="op">=</span><span class="st">'confidence'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-27"><a href="#cb17-27"></a></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Top Association Rule:"</span>)</span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="bu">print</span>(rules[[<span class="st">'antecedents'</span>,<span class="st">'consequents'</span>,<span class="st">'support'</span>,<span class="st">'confidence'</span>,<span class="st">'lift'</span>]].head(<span class="dv">5</span>))</span>
<span id="cb17-30"><a href="#cb17-30"></a></span>
<span id="cb17-31"><a href="#cb17-31"></a>species_rules <span class="op">=</span> rules[rules[<span class="st">'consequents'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.contains(<span class="st">'species'</span>, case<span class="op">=</span><span class="va">False</span>, na<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Rules predicting Species (class labels):"</span>)</span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="bu">print</span>(species_rules[[<span class="st">'antecedents'</span>, <span class="st">'consequents'</span>, <span class="st">'confidence'</span>, <span class="st">'lift'</span>]].head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Top Association Rule:
                                           antecedents  \
672  (sepal length (cm)_sepal length (cm)=Medium, p...   
664  (petal length (cm)_petal length (cm)=Low, sepa...   
674  (petal length (cm)_petal length (cm)=Medium, s...   
661  (petal width (cm)_petal width (cm)=Low, sepal ...   
658  (species_species=setosa, sepal width (cm)_sepa...   

                                           consequents  support  confidence  \
672         (petal width (cm)_petal width (cm)=Medium)     0.16         1.0   
664  (sepal length (cm)_sepal length (cm)=Low, peta...     0.10         1.0   
674                       (species_species=versicolor)     0.16         1.0   
661  (sepal length (cm)_sepal length (cm)=Low, peta...     0.10         1.0   
658  (sepal length (cm)_sepal length (cm)=Low, peta...     0.10         1.0   

         lift  
672  2.884615  
664  3.333333  
674  3.000000  
661  3.333333  
658  3.333333  

Rules predicting Species (class labels):
                                           antecedents  \
664  (petal length (cm)_petal length (cm)=Low, sepa...   
674  (petal length (cm)_petal length (cm)=Medium, s...   
661  (petal width (cm)_petal width (cm)=Low, sepal ...   
302  (petal width (cm)_petal width (cm)=Low, petal ...   
248  (petal width (cm)_petal width (cm)=High, sepal...   

                                           consequents  confidence      lift  
664  (sepal length (cm)_sepal length (cm)=Low, peta...         1.0  3.333333  
674                       (species_species=versicolor)         1.0  3.000000  
661  (sepal length (cm)_sepal length (cm)=Low, peta...         1.0  3.333333  
302                           (species_species=setosa)         1.0  3.000000  
248                        (species_species=virginica)         1.0  3.000000  </code></pre>
</div>
</div>
<ul>
<li>Insurance regression had limited prediction accuracy (MSE: 0.03, R²: 0.0029).</li>
<li>K-Means isolated Setosa clearly; other species overlapped.</li>
<li>Apriori found 100% confidence rules linking petal width/length to species.</li>
</ul>
</section>
</section>
</section>
<section id="implications" class="level2">
<h2 class="anchored" data-anchor-id="implications">Implications</h2>
<ul>
<li>Proper preprocessing is critical for robust model building.</li>
<li>Simple ML models are effective on clean, structured datasets.</li>
<li>Rule mining and clustering can reveal interpretable patterns aiding decision-making.</li>
</ul>
</section>
<section id="insights-and-analysis" class="level2">
<h2 class="anchored" data-anchor-id="insights-and-analysis">Insights and Analysis</h2>
<ul>
<li>This analysis demonstrates the value of diverse ML techniques:</li>
<li>Regression helps quantify relationships.</li>
<li>Clustering identifies natural groupings.</li>
<li>Association rules reveal hidden dependencies.</li>
</ul>
<p>Together, these methods provide a holistic approach to understanding structured data.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The overall research reinforces that effective preprocessing and appropriate model selection are crucial for success. Future work should explore feature engineering, ensemble models, and deep learning for enhanced prediction accuracy.</p>
<p>Interactive HTML on <a href="https://omkarninav.github.io/Classification-report/Assignment_Report.html">ML_Report</a></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li><p>scikit-learn documentation: <a href="https://scikit-learn.org/">scikit</a></p></li>
<li><p><a href="https://pandas.pydata.org/docs/user_guide/index.html">pandas</a>, <a href="https://seaborn.pydata.org/tutorial.html">seaborn</a>, <a href="https://matplotlib.org/cheatsheets/">matplotlib</a> official docs</p></li>
<li><p>Original <a href="https://www.kaggle.com/competitions/playground-series-s4e12/data">Insurance Premium</a> and Iris datasets</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>